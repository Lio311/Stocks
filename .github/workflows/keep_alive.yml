name: Keep Streamlit Apps Alive (with Selenium)

on:
  schedule:
    # Run every 45 minutes
    - cron: '*/45 * * * *'
  workflow_dispatch:
    # Allows manual run for testing purposes

jobs:
  wake-apps-matrix:
    runs-on: ubuntu-latest
    
    strategy:
      fail-fast: false
      matrix:
        app_url:
          - "https://liostocks.streamlit.app"
          - "https://fourieropticssimulator.streamlit.app"
          - "https://rppgvitalsanalyzer.streamlit.app"
          - "https://gaitanalysis3.streamlit.app"
          - "https://ecgarrhythmiasimulator.streamlit.app"
          - "https://ringsimulator.streamlit.app"
          - "https://physiosimulator.streamlit.app"
          - "https://smartriagegantt.streamlit.app"
          - "https://perfumegenerator.streamlit.app/"
          - "https://dentalcarriesdetector.streamlit.app/"

    steps:
      # 1. Check out the Repo (to get access to the Python script)
      - name: Check out repository
        uses: actions/checkout@v4

      # 2. Set up Python
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      # 3. Set up Chrome Browser & WebDriver (the correct way)
      #    This replaces the previous apt-get command
      - name: Set up Chrome & ChromeDriver
        uses: browser-actions/setup-chrome@v1
      
      # 4. Install Python dependencies (Selenium)
      - name: Install Python dependencies
        run: pip install selenium

      # 5. Run the Python script
      - name: Run wake-up script for ${{ matrix.app_url }}
        run: python wake_app.py ${{ matrix.app_url }}
